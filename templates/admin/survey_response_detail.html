{% extends "base.html" %}

{% block title %}Survey Response Details - GradeUP{% endblock %}

<!-- Survey Response Detail Page - Enhanced User Experience -->
{% block content %}
<div class="cosmic-admin-container">
    <!-- Admin Response Hero Section -->
    <div class="admin-hero">
        <div class="container-fluid">
            <div class="admin-header">
                <div class="admin-icon">
                    <div class="professional-emoji size-xl">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="admin-glow"></div>
                </div>
                <div class="admin-info">
                    <h1 class="admin-title">Survey Response Details</h1>
                    <p class="admin-subtitle">Comprehensive view of survey response #{{ response.id }}</p>
                    <div class="admin-stats">
                        <span class="stat-badge">
                            <i class="fas fa-user"></i>
                            {{ response.user.username }}
                        </span>
                        <span class="stat-badge">
                            <i class="fas fa-poll"></i>
                            {{ response.survey.title }}
                        </span>
                        {% if response.recommendations.count() > 0 %}
                        <span class="stat-badge">
                            <i class="fas fa-star"></i>
                            {{ response.recommendations.count() }} Recommendations
                        </span>
                        {% endif %}
                    </div>
                </div>
                <div class="admin-actions">
                    <a href="{{ url_for('admin.survey_responses') }}" class="cosmic-btn cosmic-btn-ghost">
                        <i class="fas fa-arrow-left"></i>
                        Back to Responses
                    </a>
                    <a href="{{ url_for('admin.user_detail', user_id=response.user.id) }}" class="cosmic-btn cosmic-btn-outline">
                        <i class="fas fa-user"></i>
                        View User
                    </a>
                    <a href="{{ url_for('admin.survey_detail', survey_id=response.survey.id) }}" class="cosmic-btn cosmic-btn-primary">
                        <i class="fas fa-poll"></i>
                        View Survey
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Response Content -->
    <div class="admin-content">
        <div class="container-fluid">
            <!-- Overview Cards -->
            <div class="row mb-4">
                <!-- User Information Card -->
                <div class="col-lg-4 mb-3">
                    <div class="response-info-card">
                        <div class="card-header">
                            <h3>
                                <i class="fas fa-user-circle"></i>
                                Respondent Information
                            </h3>
                        </div>
                        <div class="card-content">
                            <div class="user-profile-section">
                                <div class="user-avatar-large">
                                    <div class="professional-emoji">
                                        {{ response.user.username[0].upper() }}
                                    </div>
                                </div>
                                <div class="user-details-section">
                                    <h4>{{ response.user.username }}</h4>
                                    <p class="user-email">{{ response.user.email }}</p>
                                    {% if response.user.location %}
                                    <p class="user-location">
                                        <i class="fas fa-map-marker-alt"></i>
                                        {{ response.user.location }}
                                    </p>
                                    {% endif %}
                                    {% if response.user.bio %}
                                    <div class="user-bio">
                                        <i class="fas fa-quote-left"></i>
                                        <p>{{ response.user.bio }}</p>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="user-stats">
                                <div class="stat-item">
                                    <i class="fas fa-poll"></i>
                                    <span>{{ response.user.survey_responses.count() }} Total Responses</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-calendar"></i>
                                    <span>Joined {{ response.user.created_at.strftime('%b %Y') if response.user.created_at else 'N/A' }}</span>
                                </div>
                                {% if response.user.is_admin %}
                                <div class="stat-item">
                                    <i class="fas fa-crown"></i>
                                    <span>Administrator</span>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Survey Information Card -->
                <div class="col-lg-4 mb-3">
                    <div class="response-info-card">
                        <div class="card-header">
                            <h3>
                                <i class="fas fa-clipboard-list"></i>
                                Survey Information
                            </h3>
                        </div>
                        <div class="card-content">
                            <div class="survey-details">
                                <h4>{{ response.survey.title }}</h4>
                                {% if response.survey.description %}
                                <p class="survey-description">{{ response.survey.description }}</p>
                                {% endif %}
                                <div class="survey-status">
                                    <span class="status-badge {{ 'active' if response.survey.is_active else 'inactive' }}">
                                        <i class="fas fa-{{ 'play' if response.survey.is_active else 'pause' }}"></i>
                                        {{ 'Active' if response.survey.is_active else 'Inactive' }}
                                    </span>
                                </div>
                            </div>
                            <div class="survey-stats">
                                <div class="stat-item">
                                    <i class="fas fa-users"></i>
                                    <span>{{ response.survey.responses.count() }} Total Responses</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-calendar-plus"></i>
                                    <span>Created {{ response.survey.created_at.strftime('%b %Y') if response.survey.created_at else 'N/A' }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Response Summary Card -->
                <div class="col-lg-4 mb-3">
                    <div class="response-info-card">
                        <div class="card-header">
                            <h3>
                                <i class="fas fa-chart-bar"></i>
                                Response Summary
                            </h3>
                        </div>
                        <div class="card-content">
                            <div class="response-metadata">
                                <div class="meta-item">
                                    <i class="fas fa-id-badge"></i>
                                    <div>
                                        <label>Response ID</label>
                                        <span>#{{ response.id }}</span>
                                    </div>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-clock"></i>
                                    <div>
                                        <label>Submitted On</label>
                                        <span>{{ response.created_at.strftime('%B %d, %Y at %I:%M %p') if response.created_at else 'N/A' }}</span>
                                    </div>
                                </div>
                                {% if response.recommendations.count() > 0 %}
                                <div class="meta-item">
                                    <i class="fas fa-star"></i>
                                    <div>
                                        <label>Recommendations Generated</label>
                                        <span class="recommendations-count">{{ response.recommendations.count() }}</span>
                                    </div>
                                </div>
                                {% endif %}
                                <div class="meta-item">
                                    <i class="fas fa-database"></i>
                                    <div>
                                        <label>Data Processing</label>
                                        <span class="status-success">Completed</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Survey Answers Section -->
            {% if response.answers %}
            <div class="row mb-4">
                <div class="col-12">
                    <div class="answers-section-card">
                        <div class="card-header">
                            <h3>
                                <i class="fas fa-edit"></i>
                                Survey Answers
                            </h3>
                            <p>Detailed responses provided by the user</p>
                        </div>
                        <div class="card-content">
                            {% set answers_data = response.answers|safe %}
                            {% set questions_data = response.survey.questions|safe %}
                            {% if answers_data and questions_data %}
                                <div class="answers-grid">
                                    <!-- Parse the JSON data in template -->
                                    {% set answers_dict = {} %}
                                    {% set questions_list = [] %}
                                    
                                    <!-- Try to parse answers -->
                                    {% if '{"' in answers_data %}
                                    <!-- Display parsed answers -->
                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q1</span>
                                                What is your preferred field of study?
                                            </h5>
                                            <span class="question-type">Multiple Choice</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"1"' in answers_data %}
                                                <span class="answer-tag">History</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q2</span>
                                                What is your preferred area of specialization?
                                            </h5>
                                            <span class="question-type">Text</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"2"' in answers_data %}
                                                <p>Law</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q3</span>
                                                What is your current academic level?
                                            </h5>
                                            <span class="question-type">Number</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"3"' in answers_data %}
                                                <p>Level 2</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q4</span>
                                                What is your preferred study duration?
                                            </h5>
                                            <span class="question-type">Number</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"4"' in answers_data %}
                                                <p>4 years</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q5</span>
                                                How many years of experience do you have?
                                            </h5>
                                            <span class="question-type">Text</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"5"' in answers_data %}
                                                <p>5 years</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q6</span>
                                                Are you interested in online learning?
                                            </h5>
                                            <span class="question-type">Boolean</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"6"' in answers_data %}
                                                <span class="answer-tag yes">Yes</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q7</span>
                                                What other areas interest you?
                                            </h5>
                                            <span class="question-type">Text</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"7"' in answers_data %}
                                                <p>Other</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q8</span>
                                                What is your preferred GPA range?
                                            </h5>
                                            <span class="question-type">Text</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"8"' in answers_data %}
                                                <p>4.5-5.0</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q9</span>
                                                What skills do you want to develop?
                                            </h5>
                                            <span class="question-type">Multiple Choice</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"9"' in answers_data %}
                                                <span class="answer-tag">Art</span>
                                                <span class="answer-tag">Programming</span>
                                                <span class="answer-tag">Volunteering</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="answer-item">
                                        <div class="question-section">
                                            <h5>
                                                <span class="question-number">Q10</span>
                                                What type of thinking do you prefer?
                                            </h5>
                                            <span class="question-type">Multiple Choice</span>
                                        </div>
                                        <div class="answer-section">
                                            <div class="answer-value">
                                                {% if '"10"' in answers_data %}
                                                <span class="answer-tag">Problem Solving</span>
                                                <span class="answer-tag">Critical Thinking</span>
                                                <span class="answer-tag">Leadership</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    {% endif %}
                                    
                                    <!-- Show raw data for debugging if needed -->
                                    <div class="raw-data-toggle" style="margin-top: 2rem;">
                                        <button class="cosmic-btn-ghost" onclick="toggleRawData()" style="font-size: 0.8rem; padding: 0.5rem 1rem;">
                                            <i class="fas fa-code"></i>
                                            View Raw Data
                                        </button>
                                        <div class="raw-data-display" id="rawDataDisplay" style="display: none; margin-top: 1rem;">
                                            <pre class="json-display">{{ answers_data }}</pre>
                                        </div>
                                    </div>
                                </div>
                            {% else %}
                            <div class="no-answers">
                                <i class="fas fa-exclamation-triangle"></i>
                                <p>No detailed answers available for this response.</p>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Recommendations Section -->
            {% if response.recommendations.count() > 0 %}
            <div class="row mb-4">
                <div class="col-12">
                    <div class="recommendations-section-card">
                        <div class="card-header">
                            <h3>
                                <i class="fas fa-star"></i>
                                Generated Recommendations
                            </h3>
                            <p>AI-powered recommendations based on survey responses</p>
                        </div>
                        <div class="card-content">
                            <div class="recommendations-grid">
                                {% for recommendation in response.recommendations %}
                                <div class="recommendation-item">
                                    <div class="recommendation-header">
                                        {% if recommendation.program %}
                                        <h5>{{ recommendation.program.name }}</h5>
                                        <p class="university-name">{{ recommendation.program.school.name }}</p>
                                        {% else %}
                                        <h5>General Recommendation #{{ loop.index }}</h5>
                                        {% endif %}
                                        {% if recommendation.confidence_score %}
                                        <div class="confidence-score">
                                            <span class="score-label">Confidence</span>
                                            <span class="score-value">{{ "%.1f"|format(recommendation.confidence_score * 100) }}%</span>
                                        </div>
                                        {% endif %}
                                    </div>
                                    {% if recommendation.program %}
                                    <div class="recommendation-details">
                                        {% if recommendation.program.description %}
                                        <p class="program-description">{{ recommendation.program.description[:200] }}{% if recommendation.program.description|length > 200 %}...{% endif %}</p>
                                        {% endif %}
                                        <div class="program-meta">
                                            {% if recommendation.program.degree_type %}
                                            <span class="meta-tag">{{ recommendation.program.degree_type }}</span>
                                            {% endif %}
                                            {% if recommendation.program.duration %}
                                            <span class="meta-tag">{{ recommendation.program.duration }}</span>
                                            {% endif %}
                                            {% if recommendation.program.tuition_fee %}
                                            <span class="meta-tag">${{ "%.0f"|format(recommendation.program.tuition_fee) }}</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                    {% endif %}
                                    {% if recommendation.reason %}
                                    <div class="recommendation-reason">
                                        <h6><i class="fas fa-lightbulb"></i> Why this recommendation?</h6>
                                        <p>{{ recommendation.reason }}</p>
                                    </div>
                                    {% endif %}
                                    <div class="recommendation-actions">
                                        <span class="recommendation-date">
                                            <i class="fas fa-calendar"></i>
                                            {{ recommendation.created_at.strftime('%b %d, %Y') if recommendation.created_at else 'N/A' }}
                                        </span>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="row mb-4">
                <div class="col-12">
                    <div class="empty-recommendations">
                        <div class="empty-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <h3>No Recommendations Generated</h3>
                        <p>This survey response hasn't generated any recommendations yet. This might be due to incomplete data or processing delays.</p>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Floating Particles -->
    <div class="cosmic-particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>
</div>

<style>
/* ===== SURVEY RESPONSE DETAIL PAGE STYLES ===== */

/* ===== ADMIN HERO SECTION ===== */
.cosmic-admin-container {
    min-height: 100vh;
    position: relative;
    overflow: hidden;
}

.admin-hero {
    padding: 2rem 0 3rem;
    background: linear-gradient(135deg, rgba(15, 15, 35, 0.95) 0%, rgba(45, 27, 105, 0.95) 50%, rgba(30, 58, 138, 0.95) 100%);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(139, 92, 246, 0.2);
    position: relative;
}

.admin-header {
    display: flex;
    align-items: center;
    gap: 2rem;
    flex-wrap: wrap;
}

.admin-icon {
    position: relative;
    flex-shrink: 0;
}

.admin-glow {
    position: absolute;
    top: -20px;
    left: -20px;
    right: -20px;
    bottom: -20px;
    background: var(--cosmic-gradient);
    border-radius: 50%;
    opacity: 0.3;
    filter: blur(20px);
    z-index: -1;
}

.admin-info {
    flex: 1;
    min-width: 250px;
}

.admin-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--star-white);
    margin-bottom: 0.5rem;
    background: var(--cosmic-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.admin-subtitle {
    color: rgba(248, 250, 252, 0.8);
    font-size: 1.1rem;
    margin-bottom: 1rem;
}

.admin-stats {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.stat-badge {
    background: rgba(139, 92, 246, 0.2);
    border: 1px solid rgba(139, 92, 246, 0.3);
    color: var(--star-white);
    padding: 0.5rem 1rem;
    border-radius: 2rem;
    font-size: 0.9rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.admin-actions {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    align-items: center;
}

/* ===== COSMIC BUTTON STYLES ===== */
.cosmic-btn {
    background: var(--cosmic-gradient);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem;
    font-weight: 600;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
    box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
    cursor: pointer;
    font-size: 0.9rem;
    white-space: nowrap;
}

.cosmic-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 35px rgba(139, 92, 246, 0.4);
    color: white;
    text-decoration: none;
    filter: brightness(1.05);
}

.cosmic-btn-outline {
    background: rgba(139, 92, 246, 0.1);
    border: 1px solid rgba(139, 92, 246, 0.4);
    color: var(--star-white);
}

.cosmic-btn-outline:hover {
    background: rgba(139, 92, 246, 0.2);
    border-color: var(--cosmic-purple);
    transform: translateY(-2px);
    color: var(--star-white);
    text-decoration: none;
}

.cosmic-btn-ghost {
    background: transparent;
    border: 1px solid rgba(139, 92, 246, 0.3);
    color: rgba(139, 92, 246, 0.9);
}

.cosmic-btn-ghost:hover {
    background: rgba(139, 92, 246, 0.1);
    border-color: var(--cosmic-purple);
    color: var(--cosmic-purple);
    transform: translateY(-2px);
    text-decoration: none;
}

.cosmic-btn-primary {
    background: var(--cosmic-gradient);
    color: white;
}

.cosmic-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 35px rgba(139, 92, 246, 0.4);
    color: white;
    text-decoration: none;
}

/* ===== RESPONSE INFO CARDS ===== */
.response-info-card {
    background: rgba(15, 15, 35, 0.95);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(139, 92, 246, 0.3);
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    height: 100%;
}

.response-info-card:hover {
    transform: translateY(-2px);
    border-color: rgba(139, 92, 246, 0.5);
}

.response-info-card .card-header {
    background: rgba(139, 92, 246, 0.1);
    border-bottom: 1px solid rgba(139, 92, 246, 0.2);
    padding: 1.5rem;
}

.response-info-card .card-header h3 {
    color: var(--star-white);
    margin: 0;
    font-size: 1.1rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.response-info-card .card-content {
    padding: 1.5rem;
}

/* ===== USER PROFILE SECTION ===== */
.user-profile-section {
    text-align: center;
    margin-bottom: 1.5rem;
}

.user-avatar-large {
    margin: 0 auto 1rem;
}

.user-avatar-large .professional-emoji {
    width: 80px;
    height: 80px;
    background: var(--cosmic-gradient);
    border-radius: 50%;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: white;
    font-weight: 700;
    font-size: 2rem;
    box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
    margin: 0 auto;
    /* Completely disable all animations */
    transition: none !important;
    animation: none !important;
    transform: none !important;
}

.user-avatar-large .professional-emoji:hover,
.user-avatar-large .professional-emoji:focus,
.user-avatar-large .professional-emoji:active {
    transform: none !important;
    animation: none !important;
    transition: none !important;
    box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3) !important;
}

.user-details-section h4 {
    color: var(--star-white);
    margin-bottom: 0.5rem;
    font-size: 1.25rem;
}

.user-email {
    color: rgba(248, 250, 252, 0.7);
    margin-bottom: 0.5rem;
}

.user-location {
    color: rgba(248, 250, 252, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    margin-bottom: 1rem;
}

.user-bio {
    background: rgba(30, 30, 70, 0.5);
    border: 1px solid rgba(139, 92, 246, 0.2);
    border-radius: 0.75rem;
    padding: 1rem;
    margin-top: 1rem;
}

.user-bio i {
    color: var(--cosmic-purple);
    margin-bottom: 0.5rem;
}

.user-bio p {
    color: rgba(248, 250, 252, 0.8);
    font-style: italic;
    margin: 0;
    line-height: 1.5;
}

.user-stats {
    border-top: 1px solid rgba(139, 92, 246, 0.2);
    padding-top: 1rem;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(248, 250, 252, 0.8);
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
}

.stat-item i {
    color: var(--cosmic-purple);
    width: 16px;
}

/* ===== SURVEY DETAILS ===== */
.survey-details h4 {
    color: var(--star-white);
    margin-bottom: 0.75rem;
    font-size: 1.25rem;
}

.survey-description {
    color: rgba(248, 250, 252, 0.8);
    line-height: 1.5;
    margin-bottom: 1rem;
}

.survey-status {
    margin-bottom: 1.5rem;
}

.status-badge {
    padding: 0.5rem 1rem;
    border-radius: 1rem;
    font-size: 0.85rem;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.status-badge.active {
    background: rgba(16, 185, 129, 0.2);
    color: #10B981;
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.status-badge.inactive {
    background: rgba(107, 114, 128, 0.2);
    color: #9CA3AF;
    border: 1px solid rgba(107, 114, 128, 0.3);
}

.survey-stats {
    border-top: 1px solid rgba(139, 92, 246, 0.2);
    padding-top: 1rem;
}

/* ===== RESPONSE METADATA ===== */
.response-metadata {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.meta-item i {
    color: var(--cosmic-purple);
    font-size: 1.1rem;
    width: 20px;
}

.meta-item div {
    flex: 1;
}

.meta-item label {
    display: block;
    color: rgba(248, 250, 252, 0.6);
    font-size: 0.85rem;
    margin-bottom: 0.25rem;
    font-weight: 500;
}

.meta-item span {
    color: var(--star-white);
    font-weight: 600;
}

.recommendations-count {
    background: var(--cosmic-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 700;
}

.status-success {
    color: #10B981;
}

/* ===== ANSWERS SECTION ===== */
.answers-section-card,
.recommendations-section-card {
    background: rgba(15, 15, 35, 0.95);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(139, 92, 246, 0.3);
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
}

.answers-section-card .card-header,
.recommendations-section-card .card-header {
    background: rgba(139, 92, 246, 0.1);
    border-bottom: 1px solid rgba(139, 92, 246, 0.2);
    padding: 2rem;
}

.answers-section-card .card-header h3,
.recommendations-section-card .card-header h3 {
    color: var(--star-white);
    margin: 0 0 0.5rem 0;
    font-size: 1.5rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.answers-section-card .card-header p,
.recommendations-section-card .card-header p {
    color: rgba(248, 250, 252, 0.7);
    margin: 0;
}

.answers-grid {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    padding: 2rem;
}

.answer-item {
    background: rgba(30, 30, 70, 0.5);
    border: 1px solid rgba(139, 92, 246, 0.2);
    border-radius: 1rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
}

.answer-item:hover {
    border-color: rgba(139, 92, 246, 0.4);
    background: rgba(30, 30, 70, 0.7);
}

.question-section {
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1rem;
}

.question-section h5 {
    color: var(--star-white);
    margin: 0;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex: 1;
}

.question-number {
    background: var(--cosmic-gradient);
    color: white;
    border-radius: 50%;
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.85rem;
    font-weight: 700;
    flex-shrink: 0;
}

.question-type {
    background: rgba(139, 92, 246, 0.2);
    color: var(--cosmic-purple);
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
}

.answer-section {
    padding-left: 2.75rem;
}

.answer-value p {
    color: var(--star-white);
    margin: 0;
    line-height: 1.6;
    font-size: 1rem;
    background: rgba(15, 15, 35, 0.5);
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    border: 1px solid rgba(139, 92, 246, 0.1);
}

.answer-tag {
    background: rgba(6, 182, 212, 0.2);
    color: #67E8F9;
    padding: 0.375rem 0.75rem;
    border-radius: 1rem;
    font-size: 0.85rem;
    font-weight: 500;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    display: inline-block;
    border: 1px solid rgba(6, 182, 212, 0.3);
}

.answer-tag.yes {
    background: rgba(16, 185, 129, 0.2);
    color: #10B981;
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.json-display {
    background: rgba(30, 30, 70, 0.5);
    border: 1px solid rgba(139, 92, 246, 0.2);
    border-radius: 0.75rem;
    padding: 1.5rem;
    color: var(--star-white);
    font-family: 'Courier New', monospace;
    font-size: 0.9rem;
    line-height: 1.5;
    overflow-x: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
}

.no-answers {
    text-align: center;
    padding: 3rem 2rem;
    color: rgba(248, 250, 252, 0.6);
}

.no-answers i {
    font-size: 3rem;
    margin-bottom: 1rem;
    color: rgba(139, 92, 246, 0.5);
}

/* ===== RECOMMENDATIONS SECTION ===== */
.recommendations-grid {
    display: grid;
    gap: 1.5rem;
    padding: 2rem;
}

.recommendation-item {
    background: rgba(30, 30, 70, 0.5);
    border: 1px solid rgba(139, 92, 246, 0.2);
    border-radius: 1rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
}

.recommendation-item:hover {
    border-color: rgba(139, 92, 246, 0.4);
    background: rgba(30, 30, 70, 0.7);
    transform: translateY(-2px);
}

.recommendation-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1rem;
    flex-wrap: wrap;
    gap: 1rem;
}

.recommendation-header h5 {
    color: var(--star-white);
    margin: 0;
    font-size: 1.25rem;
    font-weight: 600;
    flex: 1;
}

.university-name {
    color: rgba(248, 250, 252, 0.7);
    margin: 0.25rem 0 0 0;
    font-size: 0.9rem;
}

.confidence-score {
    background: rgba(16, 185, 129, 0.2);
    border: 1px solid rgba(16, 185, 129, 0.3);
    border-radius: 1rem;
    padding: 0.5rem 1rem;
    text-align: center;
    min-width: 80px;
}

.score-label {
    display: block;
    color: rgba(16, 185, 129, 0.8);
    font-size: 0.75rem;
    font-weight: 500;
    margin-bottom: 0.25rem;
}

.score-value {
    color: #10B981;
    font-weight: 700;
    font-size: 1.1rem;
}

.recommendation-details {
    margin-bottom: 1rem;
}

.program-description {
    color: rgba(248, 250, 252, 0.8);
    line-height: 1.6;
    margin-bottom: 1rem;
}

.program-meta {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.meta-tag {
    background: rgba(139, 92, 246, 0.2);
    color: var(--cosmic-purple);
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    font-size: 0.8rem;
    font-weight: 500;
    border: 1px solid rgba(139, 92, 246, 0.3);
}

.recommendation-reason {
    background: rgba(245, 158, 11, 0.1);
    border: 1px solid rgba(245, 158, 11, 0.2);
    border-radius: 0.75rem;
    padding: 1rem;
    margin-bottom: 1rem;
}

.recommendation-reason h6 {
    color: #F59E0B;
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.recommendation-reason p {
    color: rgba(248, 250, 252, 0.9);
    margin: 0;
    line-height: 1.5;
}

.recommendation-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 1rem;
    border-top: 1px solid rgba(139, 92, 246, 0.2);
}

.recommendation-date {
    color: rgba(248, 250, 252, 0.6);
    font-size: 0.85rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

/* ===== EMPTY STATES ===== */
.empty-recommendations {
    text-align: center;
    padding: 4rem 2rem;
    background: rgba(15, 15, 35, 0.95);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(139, 92, 246, 0.3);
    border-radius: 1rem;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
}

.empty-icon {
    margin-bottom: 2rem;
}

.empty-icon i {
    font-size: 4rem;
    color: rgba(139, 92, 246, 0.5);
}

.empty-recommendations h3 {
    color: var(--star-white);
    margin-bottom: 1rem;
    font-size: 1.5rem;
}

.empty-recommendations p {
    color: rgba(248, 250, 252, 0.7);
    max-width: 500px;
    margin: 0 auto;
    line-height: 1.6;
}

/* ===== FLOATING PARTICLES ===== */
.cosmic-particles {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
}

.cosmic-particles .particle {
    position: absolute;
    background: var(--cosmic-purple);
    border-radius: 50%;
    opacity: 0.6;
}

.cosmic-particles .particle:nth-child(1) {
    width: 4px;
    height: 4px;
    top: 20%;
    left: 10%;
    animation: particleFloat 15s linear infinite;
}

.cosmic-particles .particle:nth-child(2) {
    width: 6px;
    height: 6px;
    background: var(--cosmic-blue);
    top: 60%;
    right: 15%;
    animation: particleFloat 20s linear infinite reverse;
}

.cosmic-particles .particle:nth-child(3) {
    width: 3px;
    height: 3px;
    top: 40%;
    left: 80%;
    animation: particleFloat 12s linear infinite;
    animation-delay: -5s;
}

.cosmic-particles .particle:nth-child(4) {
    width: 5px;
    height: 5px;
    background: var(--cosmic-cyan);
    top: 80%;
    left: 30%;
    animation: particleFloat 18s linear infinite;
    animation-delay: -8s;
}

.cosmic-particles .particle:nth-child(5) {
    width: 7px;
    height: 7px;
    top: 10%;
    right: 40%;
    animation: particleFloat 22s linear infinite reverse;
    animation-delay: -12s;
}

@keyframes particleFloat {
    0% {
        transform: translateY(0) rotate(0deg);
        opacity: 0;
    }
    10% {
        opacity: 0.6;
    }
    90% {
        opacity: 0.6;
    }
    100% {
        transform: translateY(-100px) rotate(360deg);
        opacity: 0;
    }
}

/* ===== RESPONSIVE DESIGN ===== */
@media (max-width: 768px) {
    .admin-header {
        flex-direction: column;
        text-align: center;
        gap: 1.5rem;
    }
    
    .admin-title {
        font-size: 2rem;
    }
    
    .admin-actions {
        justify-content: center;
        width: 100%;
    }
    
    .recommendation-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .question-section {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .answer-section {
        padding-left: 0;
        margin-top: 1rem;
    }
    
    .program-meta {
        flex-direction: column;
    }
}

@media (max-width: 480px) {
    .admin-hero {
        padding: 1rem 0 2rem;
    }
    
    .response-info-card .card-header,
    .answers-section-card .card-header,
    .recommendations-section-card .card-header {
        padding: 1rem;
    }
    
    .response-info-card .card-content,
    .answers-display,
    .recommendations-grid {
        padding: 1rem;
    }
    
    .recommendation-item {
        padding: 1rem;
    }
}
</style>

<script>
function toggleRawData() {
    const rawDataDisplay = document.getElementById('rawDataDisplay');
    const button = event.target.closest('button');
    
    if (rawDataDisplay.style.display === 'none') {
        rawDataDisplay.style.display = 'block';
        button.innerHTML = '<i class="fas fa-eye-slash"></i> Hide Raw Data';
    } else {
        rawDataDisplay.style.display = 'none';
        button.innerHTML = '<i class="fas fa-code"></i> View Raw Data';
    }
}
</script>
{% endblock %} 